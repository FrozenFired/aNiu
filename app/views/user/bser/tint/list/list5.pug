each tint in tints
	- let textTime="";
	if Date.now() - tint.ctAt > 3*24*60*60*1000
		-textTime="text-danger";

	each tinfir in tint.tinfirs
		-a;
		table.table.table-bordered.text-center
			tr(class=textTime)
				th(width="7%") 染洗日期:
				th(width="8%") #{moment(tint.ctAt).format('MM/DD/YYYY')}
				th(width="10%")
				th(colspan=tint.sizes.length+1, width="25%")
					a.btn.btn-link(href="/bsTint/"+tint._id) #{tint.code}
				th
				th(colspan=tint.sizes.length)
					.row
						.col-6.text-right
							button.sendBtn.btn.btn-secondary(type="button", id='sendBtn-'+tint._id) 收货
						.col-6.text-right
							form(method="post", action="/bsTinChangeSts", enctype="multipart/form-data")
								input(type="hidden", name="tintId", value=tint._id)
								input(type="hidden", name="target", value="bsTintFinish")
								input.btn.btn-warning(type="submit", value="完成")
			tr.bg-light
				th 样品型号
				th 染洗厂
				th 颜色
				each size in tint.sizes
					-a;
					th #{Conf.sizes[size]}
				th 合计
				th.bg-secondary(width="2%")
				each size in tint.sizes
					-a;
					th #{Conf.sizes[size]}
			form(id="sendForm-"+tint._id, method="post", action="/bsTintSend", enctype="multipart/form-data")
				input(type="hidden", name="obj[tintId]", value=tint._id)
				input(type="hidden", name="obj[tinfirId]", value=tinfir._id)
				- let i = 0, k=0, tot = 0;
				- let ztots = new Array();
				each tinsec in tinfir.tinsecs
					- i++;
					tr
						if i==1
							-a;
							th: a(href="/bsProduct/"+tinfir.pdfir._id) #{tinfir.pdfir.code}
							th: a(href="/bsTner/"+tint.tner._id) #{tint.tner.nome}
						else
							th
							th
						th.bg-light #{tinsec.pdsec.color}
						- let ctot = 0;
						each size in tint.sizes
							-let quot = '';
							each tinthd in tinsec.tinthds
								if tinthd.size == size
									- quot = tinthd.quot;
									if isNaN(ztots[size])
										-ztots[size] = quot;
									else
										-ztots[size] += quot;
									- ctot += quot;
									- tot += quot;
									- break;
							td #{quot}
						td.text-success #{ctot}
						td.bg-secondary
						each size in tint.sizes
							-let ship = '';
							-let quot = '';
							-let tinthdId = '';
							each tinthd in tinsec.tinthds
								if tinthd.size == size
									- tinthdId = tinthd._id;
									- ship = parseInt(tinthd.ship);
									- quot = parseInt(tinthd.quot);
									- break;
							td 
								if tinthdId
									- k++;
									-let shiping = quot - ship;

									if shiping > 0
										-a;
										input.iptsty2.shiping(id="shiping-"+tinthdId, type="number", name="obj[thds]["+k+"][shiping]", value=shiping)
										input(id="stock-"+tinthdId, type="hidden", value=stock)
										input(type="hidden", name="obj[thds]["+k+"][tinthdId]", value=tinthdId)
									else
										span.text-info #{ship}
				tr.text-success
					td(colspan=3)
					each size in tint.sizes
						-a;
						td #{ztots[size]}
					td: h4 #{tot}